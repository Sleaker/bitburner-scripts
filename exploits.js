/**
 * @typedef {import('./types/NetscriptDefinitions').NS} NS
 */

export const exploits = ["brutessh.exe", "ftpcrack.exe", "relaysmtp.exe", "httpworm.exe", "sqlinject.exe"];

/**
 * Counts the number of exploits that are currently unlocked
 * @param {NS} ns 
 */
export function numAvailableExploits(ns) {
    let total = 0;
    for (const exploit of exploits) {
        if (isExploitAvailable(ns, exploit)) {
            total++;
        }
    }
	return total;
}

/**
 * 
 * @param {NS} ns 
 * @param {string} exploit 
 * @returns 
 */
 export function isExploitAvailable(ns, exploit) {
	return ns.fileExists(exploit);
}

/**
 * 
 * @param {NS} ns 
 * @param {string} exploitName
 * @param {string} hostname
 */
export function runExploit(ns, exploitName, hostname) {
    switch(exploitName.toLocaleLowerCase()) {
        case "ftpcrack":
            return ns.ftpcrack(hostname);
        case "relaysmtp": 
            return ns.relaysmtp(hostname);
        case "httpworm":
            return ns.httpworm(hostname);
        case "sqlinject":
            return ns.sqlinject(hostname);
        case "brutessh":
            return ns.brutessh(hostname);
        default:

    }
}
